<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Adanpedia â€” Verified Knowledge Base</title>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        
        :root {
            --bg: #f8f9fa;
            --article-bg: #fff;
            --text: #202122;
            --text-muted: #54595d;
            --link: #3366cc;
            --link-hover: #447ff5;
            --border: #a2a9b1;
            --header-bg: #fff;
            --verified: #14866d;
            --warning: #fc3;
            --sidebar-bg: #f8f9fa;
        }
        
        body {
            font-family: 'Linux Libertine', 'Georgia', 'Times', serif;
            background: var(--bg);
            color: var(--text);
            line-height: 1.6;
        }
        
        /* Header */
        .header {
            background: var(--header-bg);
            border-bottom: 1px solid var(--border);
            padding: 0.5rem 1rem;
            display: flex;
            align-items: center;
            justify-content: space-between;
            position: sticky;
            top: 0;
            z-index: 100;
        }
        
        .logo {
            display: flex;
            align-items: center;
            gap: 0.75rem;
            text-decoration: none;
            color: var(--text);
        }
        
        .logo-icon {
            width: 50px;
            height: 50px;
            background: linear-gradient(135deg, #3366cc 0%, #14866d 100%);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            color: #fff;
            font-size: 1.5rem;
            font-weight: bold;
            font-family: sans-serif;
        }
        
        .logo-text h1 {
            font-size: 1.5rem;
            font-weight: normal;
            font-style: italic;
        }
        
        .logo-text p {
            font-size: 0.75rem;
            color: var(--text-muted);
        }
        
        .search-box {
            display: flex;
            gap: 0.5rem;
        }
        
        .search-box input {
            padding: 0.5rem 1rem;
            border: 1px solid var(--border);
            border-radius: 2px;
            font-size: 0.9rem;
            width: 300px;
            font-family: sans-serif;
        }
        
        .search-box button {
            padding: 0.5rem 1rem;
            background: #f8f9fa;
            border: 1px solid var(--border);
            cursor: pointer;
            font-family: sans-serif;
        }
        
        .search-box button:hover {
            background: #fff;
        }
        
        /* Layout */
        .container {
            display: flex;
            max-width: 1400px;
            margin: 0 auto;
        }
        
        /* Sidebar */
        .sidebar {
            width: 180px;
            background: var(--sidebar-bg);
            border-right: 1px solid var(--border);
            padding: 1rem;
            min-height: calc(100vh - 60px);
        }
        
        .sidebar h3 {
            font-size: 0.8rem;
            font-weight: bold;
            text-transform: uppercase;
            color: var(--text-muted);
            margin-bottom: 0.5rem;
            font-family: sans-serif;
        }
        
        .sidebar ul {
            list-style: none;
            margin-bottom: 1.5rem;
        }
        
        .sidebar li {
            margin: 0.25rem 0;
        }
        
        .sidebar a {
            color: var(--link);
            text-decoration: none;
            font-size: 0.85rem;
        }
        
        .sidebar a:hover {
            text-decoration: underline;
        }
        
        .sidebar .stats {
            background: #fff;
            border: 1px solid var(--border);
            padding: 0.75rem;
            font-size: 0.8rem;
            margin-top: 1rem;
        }
        
        .sidebar .stats strong {
            color: var(--verified);
        }
        
        /* Main content */
        .main {
            flex: 1;
            padding: 1.5rem 2rem;
            background: var(--article-bg);
            min-height: calc(100vh - 60px);
        }
        
        .article-header {
            border-bottom: 1px solid var(--border);
            padding-bottom: 0.5rem;
            margin-bottom: 1rem;
        }
        
        .article-header h1 {
            font-size: 1.8rem;
            font-weight: normal;
        }
        
        .verified-badge {
            display: inline-flex;
            align-items: center;
            gap: 0.25rem;
            background: #d5fdf4;
            color: var(--verified);
            padding: 0.15rem 0.5rem;
            border-radius: 2px;
            font-size: 0.75rem;
            font-family: sans-serif;
            margin-left: 0.5rem;
        }
        
        /* Article list */
        .article-list {
            display: grid;
            gap: 1rem;
        }
        
        .article-card {
            border: 1px solid var(--border);
            padding: 1rem;
            background: #fff;
        }
        
        .article-card h3 {
            font-size: 1.1rem;
            margin-bottom: 0.25rem;
        }
        
        .article-card h3 a {
            color: var(--link);
            text-decoration: none;
        }
        
        .article-card h3 a:hover {
            text-decoration: underline;
        }
        
        .article-card p {
            font-size: 0.9rem;
            color: var(--text-muted);
        }
        
        .article-card .meta {
            font-size: 0.75rem;
            color: var(--text-muted);
            margin-top: 0.5rem;
            font-family: sans-serif;
        }
        
        .category-tag {
            display: inline-block;
            background: #eaecf0;
            padding: 0.1rem 0.4rem;
            border-radius: 2px;
            font-size: 0.7rem;
            font-family: sans-serif;
            margin-right: 0.25rem;
        }
        
        /* Wikipedia Import Panel */
        .import-panel {
            background: #eaf3ff;
            border: 1px solid #a3b1bf;
            padding: 1rem;
            margin-bottom: 1.5rem;
        }
        
        .import-panel h3 {
            font-size: 1rem;
            margin-bottom: 0.5rem;
            font-family: sans-serif;
        }
        
        .import-form {
            display: flex;
            gap: 0.5rem;
            margin-bottom: 0.5rem;
        }
        
        .import-form input {
            flex: 1;
            padding: 0.5rem;
            border: 1px solid var(--border);
            font-family: sans-serif;
        }
        
        .import-form button {
            padding: 0.5rem 1rem;
            background: var(--link);
            color: #fff;
            border: none;
            cursor: pointer;
            font-family: sans-serif;
        }
        
        .import-form button:hover {
            background: var(--link-hover);
        }
        
        .import-status {
            font-size: 0.85rem;
            font-family: sans-serif;
        }
        
        .import-status.success { color: var(--verified); }
        .import-status.error { color: #d33; }
        
        /* Article view */
        .article-content {
            font-size: 0.95rem;
        }
        
        .article-content p {
            margin-bottom: 1rem;
        }
        
        .infobox {
            float: right;
            width: 280px;
            margin: 0 0 1rem 1rem;
            border: 1px solid var(--border);
            background: var(--sidebar-bg);
            font-size: 0.85rem;
        }
        
        .infobox-header {
            background: var(--link);
            color: #fff;
            padding: 0.5rem;
            text-align: center;
            font-weight: bold;
        }
        
        .infobox-row {
            display: flex;
            border-bottom: 1px solid var(--border);
        }
        
        .infobox-row:last-child {
            border-bottom: none;
        }
        
        .infobox-label {
            width: 40%;
            padding: 0.4rem;
            background: #eaecf0;
            font-weight: bold;
        }
        
        .infobox-value {
            width: 60%;
            padding: 0.4rem;
        }
        
        .source-link {
            font-size: 0.8rem;
            color: var(--text-muted);
            font-family: sans-serif;
        }
        
        .source-link a {
            color: var(--link);
        }
        
        /* Tabs */
        .tabs {
            display: flex;
            border-bottom: 1px solid var(--border);
            margin-bottom: 1rem;
        }
        
        .tab {
            padding: 0.5rem 1rem;
            cursor: pointer;
            font-family: sans-serif;
            font-size: 0.9rem;
            border: 1px solid transparent;
            background: none;
            margin-bottom: -1px;
        }
        
        .tab.active {
            border: 1px solid var(--border);
            border-bottom: 1px solid #fff;
            background: #fff;
        }
        
        .tab:hover:not(.active) {
            background: #eaecf0;
        }
        
        /* Loading */
        .loading {
            text-align: center;
            padding: 2rem;
            color: var(--text-muted);
        }
        
        .loading::after {
            content: '';
            display: inline-block;
            width: 20px;
            height: 20px;
            border: 2px solid var(--border);
            border-top-color: var(--link);
            border-radius: 50%;
            animation: spin 1s linear infinite;
            margin-left: 0.5rem;
            vertical-align: middle;
        }
        
        @keyframes spin {
            to { transform: rotate(360deg); }
        }
        
        /* Categories section */
        .categories-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));
            gap: 1rem;
        }
        
        .category-card {
            border: 1px solid var(--border);
            padding: 1rem;
            text-align: center;
        }
        
        .category-card h3 {
            font-size: 1rem;
            margin-bottom: 0.25rem;
        }
        
        .category-card .count {
            font-size: 0.85rem;
            color: var(--text-muted);
        }
    </style>
</head>
<body>
    <header class="header">
        <a href="#" class="logo" onclick="showHome(); return false;">
            <div class="logo-icon">A</div>
            <div class="logo-text">
                <h1>Adanpedia</h1>
                <p>The Verified Encyclopedia</p>
            </div>
        </a>
        <div class="search-box">
            <input type="text" id="search-input" placeholder="Search Adanpedia" onkeypress="if(event.key==='Enter') search()">
            <button onclick="search()">Search</button>
        </div>
    </header>
    
    <div class="container">
        <nav class="sidebar">
            <h3>Navigation</h3>
            <ul>
                <li><a href="#" onclick="showHome(); return false;">Main Page</a></li>
                <li><a href="#" onclick="showCategories(); return false;">Categories</a></li>
                <li><a href="#" onclick="showRandom(); return false;">Random article</a></li>
            </ul>
            
            <h3>Contribute</h3>
            <ul>
                <li><a href="#" onclick="showImport(); return false;">Import from Wikipedia</a></li>
                <li><a href="#" onclick="showAddFact(); return false;">Add verified fact</a></li>
            </ul>
            
            <h3>Categories</h3>
            <ul id="category-nav"></ul>
            
            <div class="stats">
                <strong id="stat-count">0</strong> verified facts<br>
                <span id="stat-categories">0</span> categories<br>
                <span style="color: var(--verified);">100% verified</span>
            </div>
        </nav>
        
        <main class="main" id="content">
            <div class="loading">Loading knowledge base</div>
        </main>
    </div>

    <script>
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// ADANPEDIA â€” Wikipedia-style interface for the Verified Knowledge Base
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

const API_BASE = 'http://localhost:8085';

let knowledgeBase = [];
let categories = {};

async function init() {
    await loadKnowledgeBase();
    showHome();
}

async function loadKnowledgeBase() {
    try {
        const res = await fetch(`${API_BASE}/api/facts`);
        const data = await res.json();
        knowledgeBase = data.facts || [];
        categories = data.categories || {};
        
        // Update stats
        document.getElementById('stat-count').textContent = knowledgeBase.length;
        document.getElementById('stat-categories').textContent = Object.keys(categories).length;
        
        // Update category nav
        const nav = document.getElementById('category-nav');
        nav.innerHTML = Object.keys(categories).slice(0, 8).map(cat => 
            `<li><a href="#" onclick="showCategory('${cat}'); return false;">${cat}</a></li>`
        ).join('');
        
    } catch (e) {
        console.error('Failed to load KB:', e);
        document.getElementById('content').innerHTML = `
            <div class="article-header"><h1>Connection Error</h1></div>
            <p>Could not connect to the knowledge base server. Make sure it's running on port 8085.</p>
        `;
    }
}

function showHome() {
    const featured = knowledgeBase.slice(0, 10);
    const recentCategories = Object.keys(categories).slice(0, 6);
    
    document.getElementById('content').innerHTML = `
        <div class="import-panel">
            <h3>ðŸ“š Import from Wikipedia</h3>
            <div class="import-form">
                <input type="text" id="wiki-query" placeholder="Enter a Wikipedia article title (e.g., 'Albert Einstein')">
                <button onclick="importFromWikipedia()">Import</button>
            </div>
            <div class="import-status" id="import-status"></div>
        </div>
        
        <div class="article-header">
            <h1>Welcome to Adanpedia</h1>
        </div>
        
        <p>Adanpedia is a verified knowledge base containing <strong>${knowledgeBase.length}</strong> facts 
        across <strong>${Object.keys(categories).length}</strong> categories. Every fact is verified and 
        traceable to an authoritative source.</p>
        
        <p>Unlike traditional encyclopedias, every fact here has been <span class="verified-badge">âœ“ Verified</span> 
        by the Adan verification engine.</p>
        
        <h2 style="margin: 1.5rem 0 1rem; border-bottom: 1px solid var(--border); padding-bottom: 0.25rem;">
            Featured Facts
        </h2>
        
        <div class="article-list">
            ${featured.map(fact => `
                <div class="article-card">
                    <h3><a href="#" onclick="showFact(${fact.id}); return false;">${fact.key}</a></h3>
                    <p>${fact.fact}</p>
                    <div class="meta">
                        <span class="category-tag">${fact.category}</span>
                        <span class="verified-badge">âœ“ Verified</span>
                        Source: ${fact.source}
                    </div>
                </div>
            `).join('')}
        </div>
        
        <h2 style="margin: 1.5rem 0 1rem; border-bottom: 1px solid var(--border); padding-bottom: 0.25rem;">
            Browse by Category
        </h2>
        
        <div class="categories-grid">
            ${recentCategories.map(cat => `
                <div class="category-card">
                    <h3><a href="#" onclick="showCategory('${cat}'); return false;">${cat}</a></h3>
                    <div class="count">${categories[cat] || 0} articles</div>
                </div>
            `).join('')}
        </div>
    `;
}

function showCategories() {
    document.getElementById('content').innerHTML = `
        <div class="article-header">
            <h1>All Categories</h1>
        </div>
        
        <div class="categories-grid">
            ${Object.entries(categories).map(([cat, count]) => `
                <div class="category-card">
                    <h3><a href="#" onclick="showCategory('${cat}'); return false;">${cat}</a></h3>
                    <div class="count">${count} articles</div>
                </div>
            `).join('')}
        </div>
    `;
}

function showCategory(category) {
    const facts = knowledgeBase.filter(f => f.category === category);
    
    document.getElementById('content').innerHTML = `
        <div class="article-header">
            <h1>Category: ${category}</h1>
        </div>
        
        <p>${facts.length} verified facts in this category.</p>
        
        <div class="article-list">
            ${facts.map(fact => `
                <div class="article-card">
                    <h3><a href="#" onclick="showFact(${fact.id}); return false;">${fact.key}</a></h3>
                    <p>${fact.fact}</p>
                    <div class="meta">
                        <span class="verified-badge">âœ“ Verified</span>
                        Source: ${fact.source}
                    </div>
                </div>
            `).join('')}
        </div>
    `;
}

function showFact(id) {
    const fact = knowledgeBase.find(f => f.id === id);
    if (!fact) return;
    
    document.getElementById('content').innerHTML = `
        <div class="article-header">
            <h1>${fact.key} <span class="verified-badge">âœ“ Verified</span></h1>
        </div>
        
        <div class="infobox">
            <div class="infobox-header">${fact.key}</div>
            <div class="infobox-row">
                <div class="infobox-label">Category</div>
                <div class="infobox-value">${fact.category}</div>
            </div>
            <div class="infobox-row">
                <div class="infobox-label">Source</div>
                <div class="infobox-value">${fact.source}</div>
            </div>
            <div class="infobox-row">
                <div class="infobox-label">Confidence</div>
                <div class="infobox-value">${(fact.confidence * 100).toFixed(0)}%</div>
            </div>
            <div class="infobox-row">
                <div class="infobox-label">Verified</div>
                <div class="infobox-value" style="color: var(--verified);">âœ“ Yes</div>
            </div>
        </div>
        
        <div class="article-content">
            <p>${fact.fact}</p>
            
            <p class="source-link">
                Source: <a href="${fact.source_url}" target="_blank">${fact.source}</a>
            </p>
        </div>
    `;
}

function showRandom() {
    if (knowledgeBase.length === 0) return;
    const randomFact = knowledgeBase[Math.floor(Math.random() * knowledgeBase.length)];
    showFact(randomFact.id);
}

function search() {
    const query = document.getElementById('search-input').value.toLowerCase();
    if (!query) return;
    
    const results = knowledgeBase.filter(f => 
        f.key.toLowerCase().includes(query) || 
        f.fact.toLowerCase().includes(query) ||
        f.category.toLowerCase().includes(query)
    );
    
    document.getElementById('content').innerHTML = `
        <div class="article-header">
            <h1>Search Results: "${query}"</h1>
        </div>
        
        <p>${results.length} results found.</p>
        
        <div class="article-list">
            ${results.map(fact => `
                <div class="article-card">
                    <h3><a href="#" onclick="showFact(${fact.id}); return false;">${fact.key}</a></h3>
                    <p>${fact.fact}</p>
                    <div class="meta">
                        <span class="category-tag">${fact.category}</span>
                        <span class="verified-badge">âœ“ Verified</span>
                    </div>
                </div>
            `).join('')}
        </div>
    `;
}

async function importFromWikipedia() {
    const query = document.getElementById('wiki-query').value;
    if (!query) return;
    
    const status = document.getElementById('import-status');
    status.textContent = 'Fetching from Wikipedia...';
    status.className = 'import-status';
    
    try {
        const res = await fetch(`${API_BASE}/api/import/wikipedia`, {
            method: 'POST',
            headers: { 'Content-Type': 'application/json' },
            body: JSON.stringify({ query })
        });
        
        const data = await res.json();
        
        if (data.success) {
            status.textContent = `âœ“ Imported ${data.facts_added} facts from "${data.title}"`;
            status.className = 'import-status success';
            await loadKnowledgeBase();
            showHome();
        } else {
            status.textContent = `âœ— ${data.error || 'Import failed'}`;
            status.className = 'import-status error';
        }
    } catch (e) {
        status.textContent = `âœ— Connection error: ${e.message}`;
        status.className = 'import-status error';
    }
}

function showImport() {
    document.getElementById('content').innerHTML = `
        <div class="article-header">
            <h1>Import from Wikipedia</h1>
        </div>
        
        <div class="import-panel">
            <h3>ðŸ“š Add verified knowledge from Wikipedia</h3>
            <p style="margin-bottom: 1rem; font-size: 0.9rem;">
                Enter a Wikipedia article title. The system will extract key facts and verify them.
            </p>
            <div class="import-form">
                <input type="text" id="wiki-query" placeholder="Article title (e.g., 'Python (programming language)')">
                <button onclick="importFromWikipedia()">Import</button>
            </div>
            <div class="import-status" id="import-status"></div>
        </div>
        
        <h2 style="margin: 1.5rem 0 1rem;">How it works</h2>
        <ol style="margin-left: 1.5rem;">
            <li>Enter a Wikipedia article title</li>
            <li>Adan fetches the article summary from Wikipedia's API</li>
            <li>Key facts are extracted and structured</li>
            <li>Each fact is verified and added to the knowledge base</li>
            <li>Source attribution is preserved (Wikipedia)</li>
        </ol>
    `;
}

function showAddFact() {
    document.getElementById('content').innerHTML = `
        <div class="article-header">
            <h1>Add Verified Fact</h1>
        </div>
        
        <div class="import-panel" style="background: #fff;">
            <h3>âž• Add a new fact manually</h3>
            <form onsubmit="addManualFact(event)">
                <div style="margin-bottom: 0.75rem;">
                    <label style="display: block; margin-bottom: 0.25rem; font-family: sans-serif; font-size: 0.85rem;">Key (e.g., "Capital of France")</label>
                    <input type="text" id="fact-key" style="width: 100%; padding: 0.5rem; border: 1px solid var(--border);" required>
                </div>
                <div style="margin-bottom: 0.75rem;">
                    <label style="display: block; margin-bottom: 0.25rem; font-family: sans-serif; font-size: 0.85rem;">Fact</label>
                    <textarea id="fact-value" style="width: 100%; padding: 0.5rem; border: 1px solid var(--border); height: 80px;" required></textarea>
                </div>
                <div style="margin-bottom: 0.75rem;">
                    <label style="display: block; margin-bottom: 0.25rem; font-family: sans-serif; font-size: 0.85rem;">Category</label>
                    <select id="fact-category" style="width: 100%; padding: 0.5rem; border: 1px solid var(--border);">
                        ${Object.keys(categories).map(c => `<option value="${c}">${c}</option>`).join('')}
                        <option value="Other">Other</option>
                    </select>
                </div>
                <div style="margin-bottom: 0.75rem;">
                    <label style="display: block; margin-bottom: 0.25rem; font-family: sans-serif; font-size: 0.85rem;">Source</label>
                    <input type="text" id="fact-source" style="width: 100%; padding: 0.5rem; border: 1px solid var(--border);" placeholder="e.g., CIA World Factbook" required>
                </div>
                <div style="margin-bottom: 0.75rem;">
                    <label style="display: block; margin-bottom: 0.25rem; font-family: sans-serif; font-size: 0.85rem;">Source URL</label>
                    <input type="url" id="fact-url" style="width: 100%; padding: 0.5rem; border: 1px solid var(--border);" placeholder="https://...">
                </div>
                <button type="submit" style="padding: 0.5rem 1rem; background: var(--link); color: #fff; border: none; cursor: pointer;">Add Fact</button>
            </form>
            <div class="import-status" id="add-status" style="margin-top: 0.5rem;"></div>
        </div>
    `;
}

async function addManualFact(e) {
    e.preventDefault();
    
    const fact = {
        key: document.getElementById('fact-key').value,
        fact: document.getElementById('fact-value').value,
        category: document.getElementById('fact-category').value,
        source: document.getElementById('fact-source').value,
        source_url: document.getElementById('fact-url').value || '#'
    };
    
    const status = document.getElementById('add-status');
    status.textContent = 'Adding fact...';
    
    try {
        const res = await fetch(`${API_BASE}/api/facts`, {
            method: 'POST',
            headers: { 'Content-Type': 'application/json' },
            body: JSON.stringify(fact)
        });
        
        const data = await res.json();
        
        if (data.success) {
            status.textContent = 'âœ“ Fact added successfully!';
            status.className = 'import-status success';
            await loadKnowledgeBase();
        } else {
            status.textContent = `âœ— ${data.error}`;
            status.className = 'import-status error';
        }
    } catch (e) {
        status.textContent = `âœ— Error: ${e.message}`;
        status.className = 'import-status error';
    }
}

// Initialize
init();
    </script>
</body>
</html>
